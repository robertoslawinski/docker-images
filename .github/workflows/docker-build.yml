name: Build Docker Image

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Build Docker image
        run: |
          echo "ðŸ”¨ Building Docker image braga:web02"
          docker build -t braga:web02 .

      - name: List Docker images
        run: docker images

      - name: Test container runs correctly
        run: |
          echo "ðŸš€ Starting container..."
          docker run -d --name testweb -p 8080:80 braga:web02
          sleep 3
          echo "ðŸ“„ Checking index.html..."
          docker exec testweb cat /var/www/html/index.html
          docker stop testweb
          docker rm testweb
